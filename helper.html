<!DOCTYPE html>
<html lang="en" >
  <head>
    <meta charset="UTF-8">
    <title>Paradigm</title>
    <link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="img/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="imgfavicon-16x16.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
    <link rel="stylesheet" href="css/stylesheet.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <style>
    .modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 40%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
</style>

  </head>
  <embed src="music/intro.mp3" width="180" height="90" loop="true" autostart="true" hidden="true" />

  <body style ="background-color:#faf9f9; ">
  <div class="loader"></div>
    <div align="center">
<!-- 
      <img class="start-icon" src="img/pig.png">
 -->
      <h1  class="start-title"> PIGGY BANKSY HELPER </h1>
        <h4 style="padding-top: 4%" id ="page"> </h4>
          <h4 style="padding-top: 4%" id = "issue"> </h4>
          <h4 style="padding-top: 4%" id = "img"> </h4>
        <h4 style="padding-top: 4%" id = "posterimg"> </h4>

     <!--  <a href="phone01.html" class="button" style="margin-top: 4%" >START</a>  -->
		<h>

    </div>

    <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase.js"></script>
    <script>
    // Initialize Firebase
    var config = {
    apiKey: "AIzaSyBQdoWaXa7sQR4ygDgRIWKgPvro8lGr0Jg",
    authDomain: "paradigm-a42bc.firebaseapp.com",
    databaseURL: "https://paradigm-a42bc.firebaseio.com",
    projectId: "paradigm-a42bc",
    storageBucket: "paradigm-a42bc.appspot.com",
    messagingSenderId: "745403935875"
    };
    firebase.initializeApp(config);
    </script>
    <script>
      var database = firebase.database();
      var ref = database.ref('StartPage');
      var page = document.getElementById('page');
      var issue = document.getElementById('issue');
      var posterimg = document.getElementById('posterimg');
      var img = document.getElementById('img');
      var ref = firebase.database().ref().child('startStatus');
      var issueNum = 0;
      var imgNum = 0;
      
      var cur = "";
      var devices ;
      
function setup() { 
var database = firebase.database();
var ref = database.ref('devices');
ref.on('value', gotData,errData);

function gotData(data){
	 var scores = data.val();
	 var keys = Object.keys(scores);
	var devices = keys.length;
		
	 for (var i = 0; i < keys.length; i++){
 	 	var k = keys[i];
 	 	if(scores[k].issue == null){	
 	 	}
 	 	else{
 	 		issueNum ++;
 	 	}	
 	 	}
 	 	issue.innerHTML = ( "Num of issue finished: <br>" + issueNum + " / "+devices);
 	 	
 	 	
 	 	
 	 	for (var i = 0; i < keys.length; i++){
 	 	var k = keys[i];
 	 	if(scores[k].img == null){	
 	 	}
 	 	else{
 	 		imgNum ++;
 	 	}	
 	 	}
 	 	img.innerHTML = ("Num of poster finished: <br>" + imgNum + " / "+devices);
 	 	
 	 	var posterimgNum = 0;
 	 	 for (var i = 0; i < keys.length; i++){
 	 	var k = keys[i];
 	 	if(scores[k].posterimg == null){	
 	 	}
 	 	else{
 	 		posterimgNum ++;
 	 	}	
 	 	}
 	 	posterimg.innerHTML = ( "Num of poster finished: <br>" + posterimgNum + " / "+devices);
 	 	
 	 	}
 	 	
 	 	
 	 	
function errData(data){
	 alert("ERROR!" );
}


}
window.onload = setup();
	
	ref.on("value", function(snapshot) {
   console.log(snapshot.val());
   		if(snapshot.val()  ==  2  ) {
   			cur = "Write down your issue";
   			
   		}
   		if(snapshot.val()  ==  3  ) {
   			cur = "Choose one issue part";
   		}
   		if(snapshot.val()  ==  5  ) {
   			cur = "Discuss and pick slogan";
   		}
   		if(snapshot.val()  ==  6  ) {
   			cur = "Poster drawing part";
   		}
   		if(snapshot.val()  ==  7  ) {
   			cur = "Place your poster into background";
   		}
   		else{
   		cur = "Waiting Screen";
   		}
        page.innerHTML = ("Now you are on: <br>" +  cur);
	}, function (error) {
   console.log("Error: " + error.code);
	});
	
	
	
    //  var current = firebase.database().ref().child('startStatus').push();
 

    
 
  
    </script>
    <script type="text/javascript">
      $(window).load(function() {
        $(".loader").fadeOut("slow");
      });
    </script>
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1">
      <defs>
      <filter id="goo">
      <feGaussianBlur in="SourceGraphic" stdDeviation="10" result="blur" />
      <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7" result="goo" />
      <feBlend in="SourceGraphic" in2="goo" />
      </filter>
      </defs>
    </svg>
    
  </body>
</html>